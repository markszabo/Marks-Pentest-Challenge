<?php
class Challenge{
public $level;
public $title;
public $text;
public $formField;
public $hint;
public $nextUrl;
public $password;
public $solvedBy;

public function Challenge($level, $title, $text, $formField, $hint, $nextUrl, $password){
	$this->level=$level;
	$this->title=$title;
	$this->text=$text;
	$this->formField=$formField;
	$this->hint=$hint;
	$this->nextUrl=$nextUrl;
	$this->password=$password;
	$this->solvedBy=Challenge::readSolvedByFromFile($level);
}

public static function readSolvedByFromFile($file){
	$myfile = fopen("leaderboard/".$file.".txt", "r") or die("Unable to open file to read!");
	$solvedBy = (int)fread($myfile,filesize("leaderboard/".$file.".txt"));
	fclose($myfile);
	return $solvedBy;
}

public function increaseSolvedBy($file, $solvedBy){
	$myfile = fopen("leaderboard/".$file.".txt", "w") or die("Unable to open file to write!");
	fwrite($myfile, ($solvedBy+1));
	fclose($myfile);
}

public function checkPasswordAndRedirect($trial){
	if($trial == $this->password){
		$this->increaseSolvedBy($this->level, $this->solvedBy);
		header("Location: index.php?site=".$this->nextUrl);
		die();
	}
	return 0; //if password was bad, otherwise already died
}

public function getLevel(){return $this->level;}
public function getTitle(){ return $this->title;}
public function getText(){ return $this->text;}
public function getFormField(){ return $this->formField;}
public function getHint(){ return $this->hint;}
public function getNextUrl(){ return $this->nextUrl;}
public function getPassword(){ return $this->password;}
public function getSolvedBy(){ return $this->solvedBy;}
}
?>
